/* ------------------------------------------------------------------------

  Form Perhitungan Kecukupan Permodalan Penyelenggara Sistem Pembayaran
  ver 1.0 - Oktober 2023

------------------------------------------------------------------------ */


var daftarPJPPIP=[];function loadDatePicker(){$("#klp_periode").datepicker({changeMonth:true,changeYear:true,showButtonPanel:true,dateFormat:"yy-mm",yearRange:"2020:"+(new Date).getFullYear(),closeText:"Pilih",beforeShow:function(a,e){$("#ui-datepicker-div").addClass("hide-calendar")},onClose:function(a,e){var t=$("#ui-datepicker-div .ui-datepicker-month :selected").val();var n=$("#ui-datepicker-div .ui-datepicker-year :selected").val();$(this).datepicker("setDate",new Date(n,t,1));refreshAktivitas()}})}function loadSumberData(){if(daftarPJPPIP.length>0)showSwal("Perhatian","Berhasil mengubah daftar PJP/PIP","success");const a=$("#csvDaftarPJPPIP").val();daftarPJPPIP=$.csv.toObjects(a);$("#csvDaftarPJPPIP_result").empty();$("#csvDaftarPJPPIP_result").html(JSON.stringify(daftarPJPPIP,null,2));$("#2_percBebanTrxDanaFloat").val((parseFloat($("#par_bebanDanaFloat").html())*100).toFixed(0));refreshKategoriIzin()}function loadMaskMoney(){$(".maskMoney").maskMoney({thousands:".",decimal:",",allowZero:true,allowNegative:true,prefix:"Rp"});$(".maskMoney").each(function(){$(this).maskMoney("mask",$(this).val())})}function refreshKategoriIzin(){load_klp_kategoriIzin($("#klp_kategoriIzin").val());refreshAktivitas()}function refreshNamaPelapor(){pelapor=$("#klp_namaPelapor").val().split("_");if(pelapor[1]=="TRUE"){$("#flagGL_PIPasing").prop("disabled",false).prop("checked",false)}else{$("#flagGL_PIPasing").prop("disabled",true).prop("checked",false)}refreshAktivitas()}function refreshAktivitas(){$("#klp_aktivitasPIP").prop("disabled",false);$("#klp_aktivitasAIS").prop("disabled",false);$("#klp_aktivitasPIAS").prop("disabled",false);$("#klp_aktivitasREM1").prop("disabled",false);$("#klp_aktivitasREM2").prop("disabled",false);$("#2_totalTrx_ATMDebet").prop("disabled",false);$("#2_totalTrx_KK").prop("disabled",false);$("#2_trxDompel").prop("disabled",false);$("#2_trxUE").prop("disabled",false);$("#2_trxPIAS_fasil").prop("disabled",false);$("#2_trxPIAS_merchAgg").prop("disabled",false);$("#2_trxLainnya").prop("disabled",false);$("#2_danaFloat").prop("disabled",false);switch($("#klp_kategoriIzin").val()){case"PIP":$("#2_konstantaTTMR").val(parseFloat($("#par_konstantaTTMR").html()).toFixed(0));$("#klp_aktivitasPIP").prop("checked",true).prop("disabled",false);$("#klp_aktivitasAIS").prop("checked",false).prop("disabled",true);$("#klp_aktivitasPIAS").prop("checked",false).prop("disabled",true);$("#klp_aktivitasREM1").prop("checked",false).prop("disabled",true);$("#klp_aktivitasREM2").prop("checked",false).prop("disabled",true);break;case"KI1":$("#2_konstantaTTMR").val(parseFloat($("#par_konstantaTTMR").html()).toFixed(0));$("#klp_aktivitasPIP").prop("checked",false).prop("disabled",true);$("#klp_aktivitasAIS").prop("disabled",false);$("#klp_aktivitasPIAS").prop("disabled",false);$("#klp_aktivitasREM1").prop("disabled",false);$("#klp_aktivitasREM2").prop("disabled",false);break;case"KI2":$("#2_konstantaTTMR").val(parseFloat($("#par_konstantaTTMR").html()).toFixed(0));$("#klp_aktivitasPIP").prop("checked",false).prop("disabled",true);$("#klp_aktivitasAIS").prop("checked",false).prop("disabled",true);$("#klp_aktivitasPIAS").prop("checked",true).prop("disabled",false);$("#klp_aktivitasREM1").prop("checked",false).prop("disabled",true);$("#klp_aktivitasREM2").prop("checked",false).prop("disabled",true);break;case"KI3":$("#2_konstantaTTMR").val(parseFloat($("#par_konstantaTTMR_KI3").html()).toFixed(0));$("#klp_aktivitasPIP").prop("checked",false).prop("disabled",true);$("#klp_aktivitasAIS").prop("checked",false).prop("disabled",true);$("#klp_aktivitasPIAS").prop("checked",false).prop("disabled",true);$("#klp_aktivitasREM1").prop("disabled",false);$("#klp_aktivitasREM2").prop("disabled",false);$("#2_totalTrx_ATMDebet").val(0).prop("disabled",true);$("#2_totalTrx_KK").val(0).prop("disabled",true);$("#2_trxDompel").val(0).prop("disabled",true);$("#2_trxUE").val(0).prop("disabled",true);$("#2_trxPIAS_fasil").val(0).prop("disabled",true);$("#2_trxPIAS_merchAgg").val(0).prop("disabled",true);$("#2_trxLainnya").val(0).prop("disabled",true);$("#2_danaFloat").val(0).prop("disabled",true);break}if($("#klp_aktivitasPIP").prop("checked")==true){$("#1_kewajibanInitCapital").val(parseFloat($("#par_initCapital_PIP").html()))}else if($("#klp_aktivitasAIS").prop("checked")==true){$("#1_kewajibanInitCapital").val(parseFloat($("#par_initCapital_AIS").html()))}else if($("#klp_aktivitasPIAS").prop("checked")==true){$("#1_kewajibanInitCapital").val(parseFloat($("#par_initCapital_PIAS").html()))}else if($("#klp_aktivitasREM1").prop("checked")==true){$("#1_kewajibanInitCapital").val(parseFloat($("#par_initCapital_REM1").html()))}else if($("#klp_aktivitasREM2").prop("checked")==true){$("#1_kewajibanInitCapital").val(parseFloat($("#par_initCapital_REM2").html()))}else{$("#1_kewajibanInitCapital").val("")}loadMaskMoney();refreshStatusPemenuhanInitialCapital();refreshPerhitunganOngoingCapital()}function refreshStatusPemenuhanInitialCapital(){$("#1_statusPemenuhan_initialCapital").removeClass("bg-danger text-bg-danger bg-success text-bg-success").val("");if($("#flagGL_PIPasing").prop("checked")){$("#1_statusPemenuhan_initialCapital").addClass("bg-success text-bg-success").val("Guarantee Letter");$("#1_tambahanInitCapital").val(0)}else{if(parseFloat($("#1_jumlahModalDisetor").maskMoney("unmasked")[0])>=parseFloat($("#1_kewajibanInitCapital").maskMoney("unmasked")[0])){$("#1_statusPemenuhan_initialCapital").addClass("bg-success text-bg-success").val("Memenuhi");$("#1_tambahanInitCapital").val(0)}else{$("#1_statusPemenuhan_initialCapital").addClass("bg-danger text-bg-danger").val("Tidak Memenuhi");$("#1_tambahanInitCapital").val((parseFloat($("#1_kewajibanInitCapital").maskMoney("unmasked")[0])-parseFloat($("#1_jumlahModalDisetor").maskMoney("unmasked")[0])).toFixed(2))}}loadMaskMoney()}function refreshPerhitunganOngoingCapital(){jmlBlnTrx=parseFloat($("#2_jumlahBulanTrx").val());$("#2_totalTrx_ATMDebet_rata").val((parseFloat($("#2_totalTrx_ATMDebet").maskMoney("unmasked")[0])/jmlBlnTrx).toFixed(2));$("#2_totalTrx_KK_rata").val((parseFloat($("#2_totalTrx_KK").maskMoney("unmasked")[0])/jmlBlnTrx).toFixed(2));$("#2_trxDompel_rata").val((parseFloat($("#2_trxDompel").maskMoney("unmasked")[0])/jmlBlnTrx).toFixed(2));$("#2_trxTrfDanaLN_inc_rata").val((parseFloat($("#2_trxTrfDanaLN_inc").maskMoney("unmasked")[0])/jmlBlnTrx).toFixed(2));$("#2_trxTrfDanaLN_out_rata").val((parseFloat($("#2_trxTrfDanaLN_out").maskMoney("unmasked")[0])/jmlBlnTrx).toFixed(2));$("#2_trxTrfDana_dom_rata").val((parseFloat($("#2_trxTrfDana_dom").maskMoney("unmasked")[0])/jmlBlnTrx).toFixed(2));$("#2_trxUE_rata").val((parseFloat($("#2_trxUE").maskMoney("unmasked")[0])/jmlBlnTrx).toFixed(2));$("#2_trxPIAS_fasil_rata").val((parseFloat($("#2_trxPIAS_fasil").maskMoney("unmasked")[0])/jmlBlnTrx*.1).toFixed(2));$("#2_trxPIAS_merchAgg_rata").val((parseFloat($("#2_trxPIAS_merchAgg").maskMoney("unmasked")[0])/jmlBlnTrx).toFixed(2));$("#2_trxLainnya_rata").val((parseFloat($("#2_trxLainnya").maskMoney("unmasked")[0])/jmlBlnTrx).toFixed(2));totalNilaiTrx=parseFloat($("#2_totalTrx_ATMDebet").maskMoney("unmasked")[0])+parseFloat($("#2_totalTrx_KK").maskMoney("unmasked")[0])+parseFloat($("#2_trxDompel").maskMoney("unmasked")[0])+parseFloat($("#2_trxTrfDanaLN_inc").maskMoney("unmasked")[0])+parseFloat($("#2_trxTrfDanaLN_out").maskMoney("unmasked")[0])+parseFloat($("#2_trxTrfDana_dom").maskMoney("unmasked")[0])+parseFloat($("#2_trxUE").maskMoney("unmasked")[0])+parseFloat($("#2_trxPIAS_fasil").maskMoney("unmasked")[0])*.1+parseFloat($("#2_trxPIAS_merchAgg").maskMoney("unmasked")[0])+parseFloat($("#2_trxLainnya").maskMoney("unmasked")[0]);totalNilaiTrxRata=parseFloat($("#2_totalTrx_ATMDebet").maskMoney("unmasked")[0])/jmlBlnTrx+parseFloat($("#2_totalTrx_KK").maskMoney("unmasked")[0])/jmlBlnTrx+parseFloat($("#2_trxDompel").maskMoney("unmasked")[0])/jmlBlnTrx+parseFloat($("#2_trxTrfDanaLN_inc").maskMoney("unmasked")[0])/jmlBlnTrx+parseFloat($("#2_trxTrfDanaLN_out").maskMoney("unmasked")[0])/jmlBlnTrx+parseFloat($("#2_trxTrfDana_dom").maskMoney("unmasked")[0])/jmlBlnTrx+parseFloat($("#2_trxUE").maskMoney("unmasked")[0])/jmlBlnTrx+parseFloat($("#2_trxPIAS_fasil").maskMoney("unmasked")[0])/jmlBlnTrx*.1+parseFloat($("#2_trxPIAS_merchAgg").maskMoney("unmasked")[0])/jmlBlnTrx+parseFloat($("#2_trxLainnya").maskMoney("unmasked")[0])/jmlBlnTrx;$("#2_totalNilaiTrx").val(totalNilaiTrx.toFixed(2));$("#2_totalNilaiTrx_rata").val(totalNilaiTrxRata.toFixed(2));bebanTrx=0;if($("#klp_kategoriIzin").val()=="KI3"){bebanTrx=(totalNilaiTrxRata*parseFloat($("#par_rateKI3").html())).toFixed(2)}else if(totalNilaiTrxRata.toFixed(2)<=1e11){bebanTrx=(totalNilaiTrxRata*parseFloat($("#par_rate_4perc").html())).toFixed(2)}else if(totalNilaiTrxRata.toFixed(2)>1e11&&totalNilaiTrxRata.toFixed(2)<=1e12){bebanTrx=(parseFloat($("#par_rate_4perc").html())*parseFloat($("#par_rateband_4perc").html())+(totalNilaiTrxRata-1e11)*parseFloat($("#par_rate_1perc").html())).toFixed(2)}else{bebanTrx=(parseFloat($("#par_rate_4perc").html())*parseFloat($("#par_rateband_4perc").html())+parseFloat($("#par_rate_1perc").html())*parseFloat($("#par_rateband_1perc").html())+(totalNilaiTrxRata-1e12)*parseFloat($("#par_rate_01perc").html())).toFixed(2)}$("#2_bebanTrx").val(parseFloat(bebanTrx).toFixed(2));$("#2_danaFloat_rata").val((parseFloat($("#2_danaFloat").maskMoney("unmasked")[0])/jmlBlnTrx).toFixed(2));bebanTrxDanaFloat=(parseFloat($("#2_danaFloat").maskMoney("unmasked")[0])/jmlBlnTrx*parseFloat($("#par_bebanDanaFloat").html())).toFixed(2);$("#2_bebanTrxDanaFloat").val(parseFloat(bebanTrxDanaFloat).toFixed(2));$("#2_totalBeban").val(parseFloat(parseFloat(bebanTrx)+parseFloat(bebanTrxDanaFloat)).toFixed(2));TTMR=(parseFloat(bebanTrx)+parseFloat(bebanTrxDanaFloat))*parseFloat($("#2_konstantaTTMR").val());$("#2_TTMR").val(TTMR.toFixed(2));modalIntiUtama=parseFloat($("#3_modalSaham").maskMoney("unmasked")[0])+parseFloat($("#3_uangMukaSetoranModal").maskMoney("unmasked")[0])+parseFloat($("#3_agioDisagioSaham").maskMoney("unmasked")[0])+parseFloat($("#3_saldoLRberjalan").maskMoney("unmasked")[0])+parseFloat($("#3_saldoPenghasilanKompr").maskMoney("unmasked")[0]);$("#3_modalIntiUtama").val(parseFloat(modalIntiUtama).toFixed(2));faktorPengurangModalInti=parseFloat($("#3_asetPajakTangguhan").maskMoney("unmasked")[0])+parseFloat($("#3_goodWill").maskMoney("unmasked")[0])+parseFloat($("#3_asetTidakBerwujud").maskMoney("unmasked")[0])+parseFloat($("#3_seluruhPenyertaan").maskMoney("unmasked")[0])+parseFloat($("#3_pembelianKembaliInstModal").maskMoney("unmasked")[0])+parseFloat($("#3_penempatanDanaInstUtang").maskMoney("unmasked")[0]);$("#3_faktorPengurangModalInti").val(parseFloat(faktorPengurangModalInti).toFixed(2));modalIntiUtama_setelahFPR=parseFloat(modalIntiUtama)-parseFloat(faktorPengurangModalInti);$("#3_modalIntiUtama_setelahFPR").val(parseFloat(modalIntiUtama_setelahFPR).toFixed(2));modalIntiTambahan=parseFloat($("#3_instrumenUtang").maskMoney("unmasked")[0])+parseFloat($("#3_instrumenHybrid").maskMoney("unmasked")[0])+parseFloat($("#3_sahamPreferenNonKumulatif").maskMoney("unmasked")[0])+parseFloat($("#3_premiumDiskonto").maskMoney("unmasked")[0]);$("#3_modalIntiTambahan").val(parseFloat(modalIntiTambahan).toFixed(2));faktorPengurangModalIntiTambahan=parseFloat($("#3_instrumenModalIntiTambahan").maskMoney("unmasked")[0])+parseFloat($("#3_kepemilikanModalIntiTambahan").maskMoney("unmasked")[0]);$("#3_faktorPengurangModalIntiTambahan").val(parseFloat(faktorPengurangModalIntiTambahan).toFixed(2));modalIntiTambahan_setelahFPR=parseFloat(modalIntiTambahan)-parseFloat(faktorPengurangModalIntiTambahan);$("#3_modalIntiTambahan_setelahFPR").val(parseFloat(modalIntiTambahan_setelahFPR).toFixed(2));modalIntiTambahan_ongoingCapital=0;if(parseFloat(modalIntiTambahan_setelahFPR)<=1/3*parseFloat(modalIntiUtama_setelahFPR)){modalIntiTambahan_ongoingCapital=parseFloat(modalIntiTambahan_setelahFPR).toFixed(2)}else{modalIntiTambahan_ongoingCapital=(1/3*parseFloat(modalIntiUtama_setelahFPR)).toFixed(2)}if(modalIntiTambahan_ongoingCapital<0)modalIntiTambahan_ongoingCapital=0;$("#3_modalIntiTambahan_ongoingCapital").val(parseFloat(modalIntiTambahan_ongoingCapital).toFixed(2));modalPelengkap=parseFloat($("#3_instrumenUtangJangkaPjg").maskMoney("unmasked")[0])+parseFloat($("#3_premiumDiskontoModalPelengkap").maskMoney("unmasked")[0]);$("#3_modalPelengkap").val(parseFloat(modalPelengkap).toFixed(2));faktorPengurangModalPelengkap=parseFloat($("#3_instrumenModalPelengkap").maskMoney("unmasked")[0])+parseFloat($("#3_kepemilikanModalPelengkap").maskMoney("unmasked")[0]);$("#3_faktorPengurangModalPelengkap").val(parseFloat(faktorPengurangModalPelengkap).toFixed(2));modalPelengkap_setelahFPR=parseFloat(modalPelengkap)-parseFloat(faktorPengurangModalPelengkap);$("#3_modalPelengkap_setelahFPR").val(parseFloat(modalPelengkap_setelahFPR).toFixed(2));modalPelengkap_ongoingCapital=0;if(parseFloat(modalPelengkap_setelahFPR)<=1/3*parseFloat(modalIntiTambahan_ongoingCapital)){modalPelengkap_ongoingCapital=parseFloat(modalPelengkap_setelahFPR).toFixed(2)}else{modalPelengkap_ongoingCapital=(1/3*parseFloat(modalIntiTambahan_ongoingCapital)).toFixed(2)}$("#3_modalPelengkap_ongoingCapital").val(parseFloat(modalPelengkap_ongoingCapital).toFixed(2));totalOngoingCapital=parseFloat(modalIntiUtama_setelahFPR)+parseFloat(modalIntiTambahan_ongoingCapital)+parseFloat(modalPelengkap_ongoingCapital);$("#3_totalOngoingCapital").val(parseFloat(totalOngoingCapital).toFixed(2));rasioKPSP=parseFloat(totalOngoingCapital)/parseFloat(TTMR)*100;if(!isNaN(rasioKPSP))$("#3_rasioKPSP").val(parseFloat(rasioKPSP).toFixed(2));KPSPdasar=0;switch($("#klp_klasifikasiPJPPIP").val()){case"PSPS":if($("#klp_aktivitasPIP").prop("checked")==true){KPSPdasar=parseFloat($("#par_PIPPSPS_KPSPdasar").html()).toFixed(2)*100}else{KPSPdasar=parseFloat($("#par_PSPS_KPSPdasar").html()).toFixed(2)*100}break;case"PSPK":KPSPdasar=parseFloat($("#par_PSPK_KPSPdasar").html()).toFixed(2)*100;break;case"PSPU":KPSPdasar=parseFloat($("#par_PSPU_KPSPdasar").html()).toFixed(2)*100;break}$("#4_KPSPdasar").val(KPSPdasar.toFixed(2));surcharge=0;if($("#klp_aktivitasPIP").prop("checked")==true&&$("#klp_klasifikasiPJPPIP").val()=="PSPS"){surcharge=parseFloat($("#par_PIPPSPS_surcharge").html()).toFixed(3)}else if($("#klp_aktivitasPIP").prop("checked")==true&&$("#klp_klasifikasiPJPPIP").val()=="PSPK"){surcharge=parseFloat($("#par_PSPS_surcharge").html()).toFixed(3)}else if($("#klp_aktivitasPIP").prop("checked")==false&&$("#klp_klasifikasiPJPPIP").val()=="PSPS"){surcharge=parseFloat($("#par_PSPS_surcharge").html()).toFixed(3)}else if($("#klp_aktivitasPIP").prop("checked")==false&&$("#klp_klasifikasiPJPPIP").val()=="PSPK"){surcharge=parseFloat($("#par_PSPK_surcharge").html()).toFixed(3)}else{surcharge=0}$("#4_surcharge").val(surcharge*100);totalKPSP=parseFloat(KPSPdasar)+parseFloat(surcharge*100);$("#4_totalKPSP").val(totalKPSP.toFixed(2));jumlahKewajibanOngoingCapital=parseFloat(parseFloat(TTMR)*parseFloat(totalKPSP)/100).toFixed(2);$("#4_jumlahKewajibanOngoingCapital").val(parseFloat(jumlahKewajibanOngoingCapital).toFixed(2));totalKebutuhanTambahanOngoingCapital=0;$("#4_statusPemenuhanOngoingCapital").removeClass("bg-success text-bg-success bg-danger text-bg-danger");if(parseFloat(totalOngoingCapital)>=parseFloat(jumlahKewajibanOngoingCapital)){$("#4_statusPemenuhanOngoingCapital").addClass("bg-success text-bg-success").val("Memenuhi");$("#4_totalKebutuhanTambahanOngoingCapital").val(0)}else{$("#4_statusPemenuhanOngoingCapital").addClass("bg-danger text-bg-danger").val("Tidak Memenuhi");totalKebutuhanTambahanOngoingCapital=parseFloat(parseFloat(jumlahKewajibanOngoingCapital)-parseFloat(totalOngoingCapital)).toFixed(2);$("#4_totalKebutuhanTambahanOngoingCapital").val(parseFloat(totalKebutuhanTambahanOngoingCapital).toFixed(2))}loadMaskMoney()}$("input:checkbox[name=klp_aktivitasEach]").click(function(){if($(this).prop("checked")==true){$("input:checkbox[name=klp_aktivitasEach]").prop("checked",false);$(this).prop("checked",true)}});var list_kategoriIzinFiltered=[];function load_klp_kategoriIzin(e,a){list_kategoriIzinFiltered=daftarPJPPIP.filter(function(a){return a.Kategori_Izin==e});strFlag_PIP_Asing="";option="<option value='N/A' selected> - Pilih Nama Pelapor - </option>";for(i=0;i<list_kategoriIzinFiltered.length;i++){if(list_kategoriIzinFiltered[i].Flag_PIP_Asing=="TRUE")strFlag_PIP_Asing=" (Asing)";option+="<option value='"+list_kategoriIzinFiltered[i].Sandi_LKPBU+"_"+list_kategoriIzinFiltered[i].Flag_PIP_Asing+"_"+i+"'>"+list_kategoriIzinFiltered[i].Sandi_LKPBU+" - "+list_kategoriIzinFiltered[i].Nama_PJSP+strFlag_PIP_Asing+"</option>"}$("#klp_namaPelapor").find("option").remove().end().append(option)}function clearData(){Swal.fire({title:"Apakah anda yakin?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:true,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(a=>{if(a.isConfirmed){$("#1_jumlahModalDisetor").val(0);loadMaskMoney();Swal.fire("Berhasil","Form has been cleared.","success")}})}function saveData(){showSwal("Perhatian","Data berhasil disimpan","success")}function loadData(){showSwal("Perhatian","Load data berhasil","success")}function exportData(e){const t=[];const n=[];if($("#klp_periode").val()==""||list_kategoriIzinFiltered.length==0||$("#klp_namaPelapor").val()=="N/A"){if(e=="export")showSwal("Gagal generate .csv","Data belum lengkap","warning");else showSwal("Gagal preview export data","Data belum lengkap","warning")}else{t[0]="Tahun";n[0]=$("#klp_periode").val().split("-")[0];t[1]="Bulan";n[1]=$("#klp_periode").val().split("-")[1];t[2]="Kategori Izin";n[2]=$("#klp_kategoriIzin").val();t[3]="Sandi LKPBU";n[3]=list_kategoriIzinFiltered[$("#klp_namaPelapor").val().split("_")[2]].Sandi_LKPBU;t[4]="Nama Pelapor";n[4]=list_kategoriIzinFiltered[$("#klp_namaPelapor").val().split("_")[2]].Nama_PJSP;exp_aktivitasPJPPIP="";if($("#klp_aktivitasPIP").prop("checked")==true){exp_aktivitasPJPPIP+=" "+$("#klp_aktivitasPIP").val()}if($("#klp_aktivitasAIS").prop("checked")==true){exp_aktivitasPJPPIP+=" "+$("#klp_aktivitasAIS").val()}if($("#klp_aktivitasPIAS").prop("checked")==true){exp_aktivitasPJPPIP+=" "+$("#klp_aktivitasPIAS").val()}if($("#klp_aktivitasREM1").prop("checked")==true){exp_aktivitasPJPPIP+=" "+$("#klp_aktivitasREM1").val()}if($("#klp_aktivitasREM2").prop("checked")==true){exp_aktivitasPJPPIP+=" "+$("#klp_aktivitasREM2").val()}t[5]="Aktivitas PJP/PIP";n[5]=exp_aktivitasPJPPIP.trim();t[6]="Klasifikasi PJP/PIP";n[6]=$("#klp_klasifikasiPJPPIP").val();t[7]="Jumlah Modal Disetor";n[7]=$("#1_jumlahModalDisetor").maskMoney("unmasked")[0];t[8]="Jumlah Kewajiban Initial Capital";n[8]=$("#1_kewajibanInitCapital").maskMoney("unmasked")[0];t[9]="Kesimpulan / Status Pemenuhan Initial capital";n[9]=$("#1_statusPemenuhan_initialCapital").val();t[10]="Total Kebutuhan Tambahan Initial Capital";n[10]=$("#1_tambahanInitCapital").maskMoney("unmasked")[0];t[11]="Transaksi Kartu Debit Tahun Laporan";n[11]=$("#2_totalTrx_ATMDebet").maskMoney("unmasked")[0];t[12]="Transaksi Kartu Kredit Tahun Laporan";n[12]=$("#2_totalTrx_KK").maskMoney("unmasked")[0];t[13]="Transaksi Dompet Elektronik Tahun Laporan";n[13]=$("#2_trxDompel").maskMoney("unmasked")[0];t[14]="Transaksi Transfer Dana LN - Incoming Tahun Laporan";n[14]=$("#2_trxTrfDanaLN_inc").maskMoney("unmasked")[0];t[15]="Transaksi Transfer Dana LN - Outgoing Tahun Laporan";n[15]=$("#2_trxTrfDanaLN_out").maskMoney("unmasked")[0];t[16]="Transaksi Transfer Dana - Domestik Tahun Laporan";n[16]=$("#2_trxTrfDana_dom").maskMoney("unmasked")[0];t[17]="Transaksi Uang Elektronik Tahun Laporan";n[17]=$("#2_trxUE").maskMoney("unmasked")[0];t[18]="Transaksi  PIAS  - Fasilitator Tahun Laporan";n[18]=$("#2_trxPIAS_fasil").maskMoney("unmasked")[0];t[19]="Transaksi PIAS - Merchant Agregator Tahun Laporan";n[19]=$("#2_trxPIAS_merchAgg").maskMoney("unmasked")[0];t[20]="Transaksi PIAS lainnya Tahun Laporan";n[20]=$("#2_trxLainnya").maskMoney("unmasked")[0];t[21]="Rata-Rata Transaksi Kartu Debit";n[21]=$("#2_totalTrx_ATMDebet_rata").maskMoney("unmasked")[0];t[22]="Rata-Rata Transaksi Kartu Kredit";n[22]=$("#2_totalTrx_KK_rata").maskMoney("unmasked")[0];t[23]="Rata-Rata Transaksi Dompet Elektronik";n[23]=$("#2_trxDompel_rata").maskMoney("unmasked")[0];t[24]="Rata-Rata Transaksi Transfer Dana LN - Incoming";n[24]=$("#2_trxTrfDanaLN_inc_rata").maskMoney("unmasked")[0];t[25]="Rata-Rata Transaksi Transfer Dana LN - Outgoing";n[25]=$("#2_trxTrfDanaLN_out_rata").maskMoney("unmasked")[0];t[26]="Rata-Rata Transaksi Transfer Dana - Domestik";n[26]=$("#2_trxTrfDana_dom_rata").maskMoney("unmasked")[0];t[27]="Rata-Rata Transaksi Uang Elektronik";n[27]=$("#2_trxUE_rata").maskMoney("unmasked")[0];t[28]="Rata-Rata Transaksi  PIAS  - Fasilitator";n[28]=$("#2_trxPIAS_fasil_rata").maskMoney("unmasked")[0];t[29]="Rata-Rata Transaksi PIAS - Merchant Agregator";n[29]=$("#2_trxPIAS_merchAgg_rata").maskMoney("unmasked")[0];t[30]="Rata-Rata Transaksi PIAS lainnya";n[30]=$("#2_trxLainnya_rata").maskMoney("unmasked")[0];t[31]="Total Nilai Transaksi Tahun Laporan";n[31]=$("#2_totalNilaiTrx").maskMoney("unmasked")[0];t[32]="Total Nilai Transaksi Rata-Rata";n[32]=$("#2_totalNilaiTrx_rata").maskMoney("unmasked")[0];t[33]="Beban Transaksi Progresif";n[33]=$("#2_bebanTrx").maskMoney("unmasked")[0];t[34]="Total Dana Float Tahun Laporan";n[34]=$("#2_danaFloat").maskMoney("unmasked")[0];t[35]="Rata-Rata Dana Float";n[35]=$("#2_danaFloat_rata").maskMoney("unmasked")[0];t[36]="% Beban Dana Float";n[36]=$("#2_percBebanTrxDanaFloat").maskMoney("unmasked")[0];t[37]="Beban Dana Float";n[37]=$("#2_bebanTrxDanaFloat").maskMoney("unmasked")[0];t[38]="Total Beban";n[38]=$("#2_totalBeban").maskMoney("unmasked")[0];t[39]="Konstanta TTMR";n[39]=$("#2_konstantaTTMR").maskMoney("unmasked")[0];t[40]="TTMR (Konstanta x Total Beban)";n[40]=$("#2_TTMR").maskMoney("unmasked")[0];t[41]="KPSP Dasar";n[41]=$("#4_KPSPdasar").maskMoney("unmasked")[0];t[42]="Surcharge Berdasarkan Klasifikasi PJP/PIP";n[42]=$("#4_surcharge").maskMoney("unmasked")[0];t[43]="Total KPSP";n[43]=$("#4_totalKPSP").maskMoney("unmasked")[0];t[44]="Ongoing Capital Requirement  (KPSP x TTMR)";n[44]=$("#4_jumlahKewajibanOngoingCapital").maskMoney("unmasked")[0];t[45]="Pemenuhan Ongoing Capital";n[45]=$("#4_statusPemenuhanOngoingCapital").maskMoney("unmasked")[0];t[46]="Total Kebutuhan Tambahan Ongoing Capital";n[46]=$("#4_totalKebutuhanTambahanOngoingCapital").maskMoney("unmasked")[0];t[47]="Modal Inti Utama";n[47]=$("#3_modalIntiUtama").maskMoney("unmasked")[0];t[48]="Modal Saham";n[48]=$("#3_modalSaham").maskMoney("unmasked")[0];t[49]="Uang Muka Setoran Modal";n[49]=$("#3_uangMukaSetoranModal").maskMoney("unmasked")[0];t[50]="Agio Saham/(Disagio Saham) - diisi negatif jika disagio";n[50]=$("#3_agioDisagioSaham").maskMoney("unmasked")[0];t[51]="Saldo Laba/(Rugi) berjalan, termasuk akumulasi laba/rugi tahun sebelumnya - diisi negatif jika rugi";n[51]=$("#3_saldoLRberjalan").maskMoney("unmasked")[0];t[52]="Saldo penghasilan komprehensif lain";n[52]=$("#3_saldoPenghasilanKompr").maskMoney("unmasked")[0];t[53]="Faktor Pengurang Modal Inti Utama";n[53]=$("#3_faktorPengurangModalInti").maskMoney("unmasked")[0];t[54]="Aset pajak tangguhan (deferred tax asset).";n[54]=$("#3_asetPajakTangguhan").maskMoney("unmasked")[0];t[55]="Goodwill.";n[55]=$("#3_goodWill").maskMoney("unmasked")[0];t[56]="Asset tidak berwujud (intangible asset).";n[56]=$("#3_asetTidakBerwujud").maskMoney("unmasked")[0];t[57]="Seluruh penyertaan dengan kepemilikan lebih dari 5% atau lebih";n[57]=$("#3_seluruhPenyertaan").maskMoney("unmasked")[0];t[58]="Pembelian kembali instrumen modal yang telah diakui sebagai komponen permodalan PJP/PIP.";n[58]=$("#3_pembelianKembaliInstModal").maskMoney("unmasked")[0];t[59]="Penempatan dana pada instrumen utang  pada entitas lainnya yang diakui sebagai komponen modal oleh entitas penerbit.";n[59]=$("#3_penempatanDanaInstUtang").maskMoney("unmasked")[0];t[60]="Modal Inti Utama (Setelah dikurangi Faktor Pengurang)";n[60]=$("#3_modalIntiUtama_setelahFPR").maskMoney("unmasked")[0];t[61]="Modal Inti Tambahan";n[61]=$("#3_modalIntiTambahan").maskMoney("unmasked")[0];t[62]="Instrumen utang, baik berupa surat utang (debt securities) dan pinjaman yang bersifat subordinasi, yang tidak memiliki  jangka waktu, dan pembayaran imbal hasil tidak dapat diakumulasikan;";n[62]=$("#3_instrumenUtang").maskMoney("unmasked")[0];t[63]="Instrumen hybrid yg tidak memiliki jangka waktu dan pembayaran imbal hasil tidak dapat diakumulasikan;";n[63]=$("#3_instrumenHybrid").maskMoney("unmasked")[0];t[64]="Saham preferen non kumulatif baik dengan atau tanpa fitur opsi beli;";n[64]=$("#3_sahamPreferenNonKumulatif").maskMoney("unmasked")[0];t[65]="Premium/diskonto yang berasal dari penerbitan instrumen yang tergolong sebagai modal inti tambahan.";n[65]=$("#3_premiumDiskonto").maskMoney("unmasked")[0];t[66]="Faktor Pengurang Modal Inti Tambahan";n[66]=$("#3_faktorPengurangModalIntiTambahan").maskMoney("unmasked")[0];t[67]="Instrumen Modal Inti Tambahan yang dimiliki sendiri (akibat kewajiban kontraktual)";n[67]=$("#3_instrumenModalIntiTambahan").maskMoney("unmasked")[0];t[68]="Kepemilikan Modal Inti Tambahan oleh pihak lain yang terindikasi merupakan skema kepemilikan silang (cross holding)";n[68]=$("#3_kepemilikanModalIntiTambahan").maskMoney("unmasked")[0];t[69]="Modal Inti Tambahan (Setelah dikurangi Faktor Pengurang)";n[69]=$("#3_modalIntiTambahan_setelahFPR").maskMoney("unmasked")[0];t[70]="Modal Inti Tambahan yang dapat diperhitungkan sebagai ongoing capital (max 1/3 modal inti utama)";n[70]=$("#3_modalIntiTambahan_ongoingCapital").maskMoney("unmasked")[0];t[71]="Modal Pelengkap";n[71]=$("#3_modalPelengkap").maskMoney("unmasked")[0];t[72]="Instrumen utang jangka panjang, baik berupa surat utang (debt securities) dan pinjaman yang bersifat subordinasi dengan maturitas â‰¥ 5thn.";n[72]=$("#3_instrumenUtangJangkaPjg").maskMoney("unmasked")[0];t[73]="Premium/diskonto yang berasal dari penerbitan instrumen yang tergolong sebagai modal pelengkap.";n[73]=$("#3_premiumDiskontoModalPelengkap").maskMoney("unmasked")[0];t[74]="Faktor Pengurang Modal Pelengkap";n[74]=$("#3_faktorPengurangModalPelengkap").maskMoney("unmasked")[0];t[75]="Instrumen Modal Pelengkap yang dimiliki sendiri (akibat kewajiban kontraktual)";n[75]=$("#3_instrumenModalPelengkap").maskMoney("unmasked")[0];t[76]="Kepemilikan Modal Pelengkap oleh pihak lain yang terindikasi merupakan skema kepemilikan silang (cross holding)";n[76]=$("#3_kepemilikanModalPelengkap").maskMoney("unmasked")[0];t[77]="Modal Pelengkap (Setelah dikurangi Faktor Pengurang)";n[77]=$("#3_modalPelengkap_setelahFPR").maskMoney("unmasked")[0];t[78]="Modal Pelengkap yang dapat diperhitungkan sebagai ongoing capital (max 1/3 modal inti tambahan)";n[78]=$("#3_modalPelengkap_ongoingCapital").maskMoney("unmasked")[0];t[79]="Total Ongoing Capital";n[79]=$("#3_totalOngoingCapital").maskMoney("unmasked")[0];t[80]="Rasio KPSP (Ongoing Capital/TTMR)";n[80]=$("#3_rasioKPSP").val();t[81]="Jumlah bulan transaksi";n[81]=$("#2_jumlahBulanTrx").val();csvExportHeader=t.map(function(a){return JSON.stringify(a)}).join(",").replace(/(^\[)|(\]$)/gm,"");csvExportRow=n.map(function(a){return JSON.stringify(a)}).join(",").replace(/(^\[)|(\]$)/gm,"");var l=new Date;var i=l.getFullYear()+""+("0"+(l.getMonth()+1)).slice(-2)+""+l.getDate();var s=l.getHours()+""+l.getMinutes();filename=""+$("#klp_periode").val().split("-")[0]+""+$("#klp_periode").val().split("-")[1]+"_"+list_kategoriIzinFiltered[$("#klp_namaPelapor").val().split("_")[2]].Sandi_LKPBU+"_"+list_kategoriIzinFiltered[$("#klp_namaPelapor").val().split("_")[2]].Nama_PJSP+"_"+i+s;let a="data:text/csv;charset=utf-8,"+csvExportHeader+"\n"+csvExportRow;if(e=="preview"){$("#previewCSVexport").empty().val(csvExportHeader+"\n"+csvExportRow);bootstrap.Modal.getOrCreateInstance("#previewModal").show()}else if(e=="export"){var o=encodeURI(a);var r=document.createElement("a");r.setAttribute("href",o);r.setAttribute("download",filename+".csv");document.body.appendChild(r);r.click();showSwal("Perhatian","Berhasil generate file .csv","success")}}}function showSwal(a,e,t){Swal.fire(a,e,t)}